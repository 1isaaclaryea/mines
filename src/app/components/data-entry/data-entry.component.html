<div class="spreadsheet-container">
    <!-- Loading Spinner Overlay -->
    <div class="loading-overlay" *ngIf="isLoading">
        <div class="loading-content">
            <mat-progress-spinner 
                mode="indeterminate" 
                diameter="60"
                color="primary">
            </mat-progress-spinner>
            <p>Loading spreadsheet data...</p>
        </div>
    </div>

    <div class="controls-row">
        <div class="controls-section">
            <mat-form-field>
                <mat-label>Select Section</mat-label>
                <mat-select [(value)]="selectedSection" (selectionChange)="onSectionChange($event)" [disabled]="isLoading">
                    <mat-option *ngFor="let section of sections" [value]="section">
                        {{section.name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="status-section" *ngIf="dataStatus">
            <mat-chip [ngClass]="{'approved': dataStatus === 'approved', 'pending': dataStatus === 'pending', 'rejected': dataStatus === 'rejected'}">
                <mat-icon>{{
                    dataStatus === 'approved' ? 'check_circle' : 
                    dataStatus === 'rejected' ? 'cancel' : 'pending'
                }}</mat-icon>
                {{
                    dataStatus === 'approved' ? 'Approved' : 
                    dataStatus === 'rejected' ? 'Rejected' : 'Pending Approval'
                }}
            </mat-chip>
        </div>
    </div>

    <div id="univer-container">
        <ejs-spreadsheet #spreadsheet allowOpen="true" openUrl="" saveUrl="">
        </ejs-spreadsheet>
    </div>
    
</div>   

<div class="centered-controls">
    <!-- Submit button (visible to all) -->
    <button mat-raised-button color="primary" (click)="submitData()" 
        [disabled]="isLoading || dataStatus === 'approved' || dataStatus === 'rejected'">
        <mat-icon>upload</mat-icon>
        Submit Data
    </button>
    
    <!-- Approve/Reject buttons (only visible to supervisors with pending data) -->
    <ng-container *ngIf="isSupervisor && dataStatus === 'pending' || dataStatus === 'rejected'">
        <button 
            mat-raised-button 
            color="accent" 
            (click)="approveData()"
            [disabled]="isLoading">
            <mat-icon>check_circle</mat-icon>
            Approve Data
        </button>
    </ng-container>
    <ng-container *ngIf="isSupervisor && dataStatus === 'approved'">
        <button 
            mat-raised-button 
            color="warn" 
            (click)="rejectData()"
            [disabled]="isLoading">
            <mat-icon>cancel</mat-icon>
            Reject Data
        </button>
    </ng-container>
</div>
